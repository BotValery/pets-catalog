const db = require('../config/database');

// –î–∞–Ω–Ω—ã–µ –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω–æ–≤ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
const shopsData = [
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ó–≤–µ—Ä—É—à–∫–∏'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 45", phone: "+7 (3022) 32-15-67", hours: "–ü–Ω-–í—Å: 9:00 - 20:00", description: "–®–∏—Ä–æ–∫–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –∫–æ—Ä–º–æ–≤ –¥–ª—è —Å–æ–±–∞–∫ –∏ –∫–æ—à–µ–∫, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∏–≥—Ä—É—à–∫–∏, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏", products: "–ö–æ—Ä–º, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∏–≥—Ä—É—à–∫–∏, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏, –≤–∏—Ç–∞–º–∏–Ω—ã" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–î—Ä—É–∂–æ–∫'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ê–º—É—Ä—Å–∫–∞—è, –¥. 28", phone: "+7 (3022) 35-24-89", hours: "–ü–Ω-–°–±: 10:00 - 19:00, –í—Å: 10:00 - 18:00", description: "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –¥–ª—è —Å–æ–±–∞–∫ –∏ –∫–æ—à–µ–∫. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ—Ä–º–∞ –ø—Ä–µ–º–∏—É–º –∫–ª–∞—Å—Å–∞", products: "–ö–æ—Ä–º –ø—Ä–µ–º–∏—É–º –∫–ª–∞—Å—Å–∞, –æ–¥–µ–∂–¥–∞, –ø–æ–≤–æ–¥–∫–∏, –æ—à–µ–π–Ω–∏–∫–∏, –º–∏—Å–∫–∏" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ö–æ—Ç –∏ –ü–µ—Å'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ß–∫–∞–ª–æ–≤–∞, –¥. 12", phone: "+7 (3022) 28-45-12", hours: "–ü–Ω-–í—Å: 8:00 - 21:00", description: "–ö—Ä—É–ø–Ω—ã–π –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω —Å –±–æ–ª—å—à–∏–º –≤—ã–±–æ—Ä–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö", products: "–ö–æ—Ä–º, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∫–ª–µ—Ç–∫–∏, –ø–µ—Ä–µ–Ω–æ—Å–∫–∏, –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–õ–∞–ø–∫–∏'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ë–∞–±—É—à–∫–∏–Ω–∞, –¥. 33", phone: "+7 (3022) 31-56-78", hours: "–ü–Ω-–ü—Ç: 9:00 - 19:00, –°–±-–í—Å: 10:00 - 18:00", description: "–£—é—Ç–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–ª—è –ø–∏—Ç–æ–º—Ü–µ–≤. –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –ø–æ–¥–±–æ—Ä—É –∫–æ—Ä–º–∞", products: "–ö–æ—Ä–º, –ª–∞–∫–æ–º—Å—Ç–≤–∞, –∏–≥—Ä—É—à–∫–∏, –ª–µ–∂–∞–Ω–∫–∏, —Å—Ä–µ–¥—Å—Ç–≤–∞ –≥–∏–≥–∏–µ–Ω—ã" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ó–æ–æ–ú–∏—Ä'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è, –¥. 7", phone: "+7 (3022) 45-67-23", hours: "–ü–Ω-–í—Å: 9:00 - 20:00", description: "–°–µ—Ç—å –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω–æ–≤. –®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º —Ü–µ–Ω–∞–º", products: "–ö–æ—Ä–º –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏, –≤–∏—Ç–∞–º–∏–Ω—ã, –ª–µ–∫–∞—Ä—Å—Ç–≤–∞" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ß–µ—Ç—ã—Ä–µ –õ–∞–ø—ã'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ê–Ω–æ—Ö–∏–Ω–∞, –¥. 56", phone: "+7 (3022) 26-78-34", hours: "–ü–Ω-–í—Å: 10:00 - 20:00", description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω —Å —à–∏—Ä–æ–∫–∏–º –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö", products: "–ö–æ—Ä–º –ø—Ä–µ–º–∏—É–º –∏ —Å—É–ø–µ—Ä-–ø—Ä–µ–º–∏—É–º –∫–ª–∞—Å—Å–∞, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∏–≥—Ä—É—à–∫–∏, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏, –≤–∏—Ç–∞–º–∏–Ω—ã" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ó–æ–æ–°—Ñ–µ—Ä–∞'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ë—É—Ç–∏–Ω–∞, –¥. 78", phone: "+7 (3022) 41-23-56", hours: "–ü–Ω-–°–±: 9:00 - 19:00, –í—Å: 10:00 - 18:00", description: "–ú–∞–≥–∞–∑–∏–Ω –∑–æ–æ—Ç–æ–≤–∞—Ä–æ–≤ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è–º–∏. –ë–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä –∫–æ—Ä–º–æ–≤ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤", products: "–ö–æ—Ä–º, –ª–∞–∫–æ–º—Å—Ç–≤–∞, –∏–≥—Ä—É—à–∫–∏, –æ–¥–µ–∂–¥–∞ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö, —Å—Ä–µ–¥—Å—Ç–≤–∞ —É—Ö–æ–¥–∞" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–•–≤–æ—Å—Ç–∏–∫'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ü–æ–ª–∏–Ω—ã –û—Å–∏–ø–µ–Ω–∫–æ, –¥. 15", phone: "+7 (3022) 38-92-14", hours: "–ü–Ω-–í—Å: 9:00 - 20:00", description: "–£—é—Ç–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–ª—è —Å–æ–±–∞–∫ –∏ –∫–æ—à–µ–∫. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É", products: "–ö–æ—Ä–º, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∏–≥—Ä—É—à–∫–∏, –ª–µ–∂–∞–Ω–∫–∏, –º–∏—Å–∫–∏, –ø–æ–≤–æ–¥–∫–∏" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ó–≤–µ—Ä—å—ë –ú–æ—ë'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ü—Ä–æ—Ñ—Å–æ—é–∑–Ω–∞—è, –¥. 42", phone: "+7 (3022) 33-67-89", hours: "–ü–Ω-–ü—Ç: 9:00 - 19:00, –°–±-–í—Å: 10:00 - 18:00", description: "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å–æ–±–∞–∫ –∏ –∫–æ—à–µ–∫. –®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –∫–æ—Ä–º–æ–≤ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤", products: "–ö–æ—Ä–º –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏, –∏–≥—Ä—É—à–∫–∏, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –≤–∏—Ç–∞–º–∏–Ω—ã" },
    { name: "–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω '–ú—É—Ä–∑–∏–∫'", address: "–≥. –ß–∏—Ç–∞, —É–ª. –ì–æ—Ä—å–∫–æ–≥–æ, –¥. 24", phone: "+7 (3022) 29-45-67", hours: "–ü–Ω-–í—Å: 10:00 - 20:00", description: "–ú–∞–≥–∞–∑–∏–Ω –∑–æ–æ—Ç–æ–≤–∞—Ä–æ–≤ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –∫–æ—à–µ–∫. –ë–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä –∫–æ—Ä–º–æ–≤, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤", products: "–ö–æ—Ä–º –¥–ª—è –∫–æ—à–µ–∫, –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏, –∏–≥—Ä—É—à–∫–∏, –∫–æ–≥—Ç–µ—Ç–æ—á–∫–∏, –ª–µ–∂–∞–Ω–∫–∏, –º–∏—Å–∫–∏" }
];

async function addShopsTable() {
    try {
        await db.connect();
        console.log('üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã shops...');

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞
        const tableExists = await db.get(
            "SELECT name FROM sqlite_master WHERE type='table' AND name='shops'"
        );

        if (!tableExists) {
            // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            await db.run(`
                CREATE TABLE shops (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL,
                    address TEXT NOT NULL,
                    phone TEXT NOT NULL,
                    hours TEXT NOT NULL,
                    description TEXT,
                    products TEXT,
                    createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
                    updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP
                )
            `);
            console.log('‚úÖ –¢–∞–±–ª–∏—Ü–∞ shops —Å–æ–∑–¥–∞–Ω–∞');

            // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
            if (shopsData && shopsData.length > 0) {
                console.log(`üì• –ò–º–ø–æ—Ä—Ç ${shopsData.length} –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω–æ–≤...`);
                for (const shop of shopsData) {
                    await db.run(`
                        INSERT INTO shops (name, address, phone, hours, description, products)
                        VALUES (?, ?, ?, ?, ?, ?)
                    `, [
                        shop.name,
                        shop.address,
                        shop.phone,
                        shop.hours,
                        shop.description || '',
                        shop.products || ''
                    ]);
                }
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω–æ–≤ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã');
            }
        } else {
            console.log('‚ÑπÔ∏è  –¢–∞–±–ª–∏—Ü–∞ shops —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
            const count = await db.get('SELECT COUNT(*) as count FROM shops');
            if (count.count === 0 && shopsData.length > 0) {
                console.log(`üì• –ò–º–ø–æ—Ä—Ç ${shopsData.length} –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω–æ–≤...`);
                for (const shop of shopsData) {
                    await db.run(`
                        INSERT INTO shops (name, address, phone, hours, description, products)
                        VALUES (?, ?, ?, ?, ?, ?)
                    `, [
                        shop.name,
                        shop.address,
                        shop.phone,
                        shop.hours,
                        shop.description || '',
                        shop.products || ''
                    ]);
                }
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω–æ–≤ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã');
            }
        }

        await db.close();
        console.log('‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
        process.exit(0);
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:', error);
        process.exit(1);
    }
}

addShopsTable();

